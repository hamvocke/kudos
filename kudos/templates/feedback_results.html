{% extends "base_page.html" %}
{% block content %}
<section id="results" class="container">
    <h1>Your feedback for '<em>{{ feedback.name }}</em>'</h1>

    <div>
        <strong>{{ feedback.votes|length }}</strong> votes so far
    </div>

    <canvas id="resultsChart" class="chart" width="400" height="400"></canvas>

    <div>
        <img src="{{ url_for('get_qrcode', feedback_id=feedback.id) }}">
    </div>

    <div>
        {% for vote in feedback.votes|sort(true, attribute='created_at') %}
        <div class="vote">
            <div class="option">{{ vote.option }}</div>
            <div>
                <div class="meta"><i class="fa fa-clock-o" aria-hidden="true"></i> {{ vote.created_at }}</div>
                <div class="comment">{{ vote.text }}</div>
            </div>
        </div>
        {% endfor %}
    </div>
</section>

<script src="{{url_for('static', filename='js/Chart.min.js')}}"></script>
<script>
var ctx = document.getElementById("resultsChart");
Chart.defaults.global.defaultFontFamily = "'Nunito', sans-serif"
var myChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
        labels: [":)", ":("],
        datasets: [{
            label: '# of Votes',
            data: [12, 19],
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)'
            ],
            borderColor: [
                'rgba(255,99,132,1)',
                'rgba(54, 162, 235, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        animation: {
            animateRotate: false
        }
    }
});
</script>
{% endblock %}
